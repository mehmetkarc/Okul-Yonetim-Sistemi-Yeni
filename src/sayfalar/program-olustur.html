<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Program OluÅŸtur - AkÄ±llÄ± Ders DaÄŸÄ±tÄ±m Sistemi</title>
    <link rel="stylesheet" href="anasayfa.css" />
    <link rel="stylesheet" href="okullar.css" />
    <link rel="stylesheet" href="program-olustur.css" />
    <link rel="stylesheet" href="../bilesenler/bildirim-sistemi.css" />
  </head>
  <body>
    <!-- Arka Plan AnimasyonlarÄ± -->
    <div class="bg-animations">
      <div class="gradient-orb orb-1"></div>
      <div class="gradient-orb orb-2"></div>
      <div class="gradient-orb orb-3"></div>
    </div>

    <!-- Ãœst Bar -->
    <header class="top-bar">
      <div class="top-bar-left">
        <div
          class="logo-container"
          onclick="window.location.href='anasayfa.html'"
        >
          <svg class="logo-icon" viewBox="0 0 24 24" fill="none">
            <path
              d="M12 3L4 9V21H20V9L12 3Z"
              stroke="url(#gradient1)"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M9 21V12H15V21"
              stroke="url(#gradient1)"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <defs>
              <linearGradient
                id="gradient1"
                x1="0%"
                y1="0%"
                x2="100%"
                y2="100%"
              >
                <stop
                  offset="0%"
                  style="stop-color: #00d9ff; stop-opacity: 1"
                />
                <stop
                  offset="100%"
                  style="stop-color: #7b2fff; stop-opacity: 1"
                />
              </linearGradient>
            </defs>
          </svg>
          <div class="logo-text">
            <span class="logo-title">Okul YÃ¶netim</span>
            <span class="logo-subtitle" id="okulAdi">Sistem</span>
          </div>
        </div>
      </div>

      <div class="top-bar-center">
        <h2 style="color: white; font-size: 20px; font-weight: 600">
          ğŸ¤– AkÄ±llÄ± Program OluÅŸturucu
        </h2>
      </div>

      <div class="top-bar-right">
        <button
          class="icon-btn"
          onclick="window.location.href='anasayfa.html'"
          title="Ana Sayfa"
        >
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path
              d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
              stroke="currentColor"
              stroke-width="2"
            />
          </svg>
        </button>

        <div class="user-menu" id="userMenu">
          <div class="user-avatar"><span id="userInitials">SA</span></div>
          <div class="user-info">
            <span class="user-name" id="userName">Admin</span>
            <span class="user-role" id="userRole">Okul YÃ¶neticisi</span>
          </div>
        </div>

        <button class="icon-btn logout-btn" id="logoutBtn" title="Ã‡Ä±kÄ±ÅŸ">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path
              d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4m7 14l5-5-5-5m5 5H9"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </button>
      </div>
    </header>

    <!-- Ana Ä°Ã§erik -->
<main class="page-container" style="padding: 20px">
  <!-- BaÅŸlÄ±k ve Kontrol ButonlarÄ± -->
  <div class="page-header" style="margin-bottom: 20px">
    <div class="header-left">
      <h1 class="page-title">
        <span class="title-icon">ğŸ¤–</span>
        AkÄ±llÄ± Program OluÅŸturucu
      </h1>
      <p class="page-description">
        Yapay zeka destekli ders daÄŸÄ±tÄ±m sistemi
      </p>
    </div>
    <div class="header-right" style="display: flex; gap: 12px; align-items: center;">
      
      <!-- âœ… TABLO OLUÅTUR (AkÄ±llÄ± Asistan - Program BaÅŸlat) -->
<button
  class="btn-primary"
  id="btnAkilliAsistan"
  style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 12px 24px; border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.3s; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);"
  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'"
  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.3)'"
>
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
  >
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
  </svg>
  <span>ğŸ“‹ Tablo OluÅŸtur</span>
</button>

<!-- âœ… OTOMATÄ°K DAÄIT (DÃœZELTÄ°LDÄ°!) -->
<button
  class="btn-primary"
  id="btnOtomatikDagit"
  onclick="window.location.href='otomatik-dagitim.html'"
  style="background: linear-gradient(135deg, #00f5a0 0%, #00d9ff 100%); padding: 12px 24px; border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.3s; box-shadow: 0 4px 12px rgba(0, 245, 160, 0.3);"
  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0, 245, 160, 0.4)'"
  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0, 245, 160, 0.3)'"
>
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
  >
    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
  </svg>
  <span>ğŸ¤– Otomatik DaÄŸÄ±t</span>
</button>

<!-- âœ… KAYDET -->
<button 
  class="btn-secondary" 
  id="btnKaydet"
  style="background: #607d8b; padding: 12px 24px; border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.3s; box-shadow: 0 4px 12px rgba(96, 125, 139, 0.3);"
  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(96, 125, 139, 0.4)'"
  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(96, 125, 139, 0.3)'"
>
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
  >
    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
    <polyline points="17 21 17 13 7 13 7 21" />
    <polyline points="7 3 7 8 15 8" />
  </svg>
  <span>ğŸ’¾ Kaydet</span>
</button>

    </div>
  </div>

      <!-- 3 Kolonlu Layout -->
      <div class="program-layout">
        <!-- SOL PANEL: Dersler ve Ã–ÄŸretmenler -->
        <div class="program-sidebar">
          <!-- Ä°statistikler -->
          <div class="sidebar-section">
            <h3 class="section-title">ğŸ“Š Ä°statistikler</h3>
            <div class="stats-mini">
              <div class="stat-mini">
                <span class="stat-mini-label">YerleÅŸen</span>
                <span class="stat-mini-value" id="statYerlesen">0/0</span>
              </div>
              <div class="stat-mini">
                <span class="stat-mini-label">Ã‡akÄ±ÅŸma</span>
                <span class="stat-mini-value" id="statCakisma">0</span>
              </div>
              <div class="stat-mini">
                <span class="stat-mini-label">BoÅŸluk</span>
                <span class="stat-mini-value" id="statBosluk">â€”</span>
              </div>
            </div>
          </div>

          <!-- Dersler -->
          <div class="sidebar-section">
            <div class="accordion-header active" id="derslerAccordion">
              <div class="accordion-title">
                <span>ğŸ“š</span>
                <span>DERSLER</span>
              </div>
              <div class="accordion-icon">â–¶</div>
            </div>
            <div class="accordion-content active" id="derslerContent">
              <div class="draggable-list" id="derslerList">
                <div class="empty-message">Dersler yÃ¼kleniyor...</div>
              </div>
            </div>
          </div>

          <!-- Ã–ÄŸretmenler -->
          <div class="sidebar-section">
            <div class="accordion-header" id="ogretmenlerAccordion">
              <div class="accordion-title">
                <span>ğŸ‘¨â€ğŸ«</span>
                <span>Ã–ÄRETMENLER</span>
              </div>
              <div class="accordion-icon">â–¶</div>
            </div>
            <div class="accordion-content" id="ogretmenlerContent">
              <div class="draggable-list" id="ogretmenlerList">
                <div class="empty-message">Ã–ÄŸretmenler yÃ¼kleniyor...</div>
              </div>
            </div>
          </div>

          <!-- SÄ±nÄ±flar -->
          <div class="sidebar-section">
            <div class="accordion-header" id="siniflarAccordion">
              <div class="accordion-title">
                <span>ğŸ›ï¸</span>
                <span>SINIFLAR</span>
              </div>
              <div class="accordion-icon">â–¶</div>
            </div>
            <div class="accordion-content" id="siniflarContent">
              <div class="draggable-list" id="siniflarList">
                <div class="empty-message">SÄ±nÄ±flar yÃ¼kleniyor...</div>
              </div>
            </div>
          </div>

          <!-- Ä°ÅŸlem GeÃ§miÅŸi -->
          <div class="sidebar-section">
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
              "
            >
              <h3 class="section-title">ğŸ“‹ Ä°ÅŸlem GeÃ§miÅŸi</h3>
              <button
                class="btn-icon-small"
                id="btnUndo"
                title="Geri Al (Ctrl+Z)"
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M3 7v6h6" />
                  <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13" />
                </svg>
              </button>
            </div>
            <div class="log-list" id="logList">
              <div class="log-item">Sistem hazÄ±r</div>
            </div>
          </div>
        </div>

        <!-- ORTA PANEL: CanlÄ± Program Tablosu -->
        <div class="program-main">
          <div class="tablo-header">
            <div class="tablo-info">
              <span id="tabloBaslik">Program Tablosu</span>
              <span class="tablo-meta" id="tabloMeta"
                >BaÅŸlamak iÃ§in AkÄ±llÄ± Asistan'Ä± kullanÄ±n</span
              >
            </div>
            <div class="tablo-actions">
              <button
                class="btn-icon"
                id="btnYenile"
                title="Tabloyu Yenile"
                style="display: none"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"
                  />
                </svg>
              </button>
              <button
                class="btn-icon btn-danger"
                id="btnSil"
                title="Tabloyu Sil"
                style="display: none"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polyline points="3 6 5 6 21 6" />
                  <path
                    d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                  />
                  <line x1="10" y1="11" x2="10" y2="17" />
                  <line x1="14" y1="11" x2="14" y2="17" />
                </svg>
              </button>
              <button
                class="btn-icon"
                id="btnSinifSec"
                title="SÄ±nÄ±f SeÃ§"
                style="display: none"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                </svg>
              </button>
              <button
                class="btn-icon"
                id="btnOgretmenSec"
                title="Ã–ÄŸretmen SeÃ§"
                style="display: none"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
              </button>
              <button
                class="btn-icon"
                id="btnZoomIn"
                title="YakÄ±nlaÅŸtÄ±r"
                style="display: none"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8" />
                  <path d="M21 21l-4.35-4.35" />
                  <line x1="11" y1="8" x2="11" y2="14" />
                  <line x1="8" y1="11" x2="14" y2="11" />
                </svg>
              </button>
              <button
                class="btn-icon"
                id="btnZoomOut"
                title="UzaklaÅŸtÄ±r"
                style="display: none"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8" />
                  <path d="M21 21l-4.35-4.35" />
                  <line x1="8" y1="11" x2="14" y2="11" />
                </svg>
              </button>
            </div>
          </div>

          <div class="tablo-container" id="tabloContainer">
            <!-- SINIF VE Ã–ÄRETMEN SEÃ‡Ä°CÄ° -->
            <div class="viewer-selector" id="viewerSelector" style="display: none;">
              <div class="selector-group">
                <label>
                  <input
                    type="radio"
                    name="viewType"
                    value="sinif"
                    id="radioViewSinif"
                    checked
                  />
                  SÄ±nÄ±f ProgramÄ±
                </label>
                <select id="selectViewSinif" class="form-select">
                  <option value="">-- SÄ±nÄ±f SeÃ§in --</option>
                </select>
              </div>

              <div class="selector-group">
  <label>
    <input
      type="radio"
      name="viewType"
      value="ogretmen"
      id="radioViewOgretmen"
    />
    ğŸ‘¨â€ğŸ« Ã–ÄŸretmen ProgramÄ±
  </label>
  <select id="selectViewOgretmen" class="form-select">
    <option value="">-- Ã–ÄŸretmen SeÃ§in --</option>
  </select>
</div>

              <button class="btn-primary" id="btnGoruntule">
                GÃ¶rÃ¼ntÃ¼le
              </button>
            </div>

            <!-- PROGRAM TABLOSU -->
            <div id="programViewTable" style="display: none;"></div>
            <div class="tablo-placeholder">
              <div style="font-size: 64px; margin-bottom: 16px">
                <svg
                  width="120"
                  height="120"
                  viewBox="0 0 120 120"
                  style="filter: drop-shadow(0 8px 16px rgba(255, 140, 0, 0.3))"
                >
                  <!-- Robot gÃ¶vdesi -->
                  <rect
                    x="30"
                    y="50"
                    width="60"
                    height="50"
                    rx="8"
                    fill="url(#robotGradient)"
                  />

                  <!-- Robot baÅŸÄ± -->
                  <rect
                    x="40"
                    y="25"
                    width="40"
                    height="30"
                    rx="6"
                    fill="url(#robotGradient)"
                  />

                  <!-- Anten -->
                  <line
                    x1="60"
                    y1="25"
                    x2="60"
                    y2="15"
                    stroke="#ff8c00"
                    stroke-width="3"
                    stroke-linecap="round"
                  />
                  <circle cx="60" cy="12" r="4" fill="#fbbf24">
                    <animate
                      attributeName="fill"
                      values="#fbbf24;#ff4500;#fbbf24"
                      dur="2s"
                      repeatCount="indefinite"
                    />
                  </circle>

                  <!-- GÃ¶zler -->
                  <circle cx="48" cy="38" r="5" fill="#60a5fa">
                    <animate
                      attributeName="r"
                      values="5;6;5"
                      dur="1.5s"
                      repeatCount="indefinite"
                    />
                  </circle>
                  <circle cx="72" cy="38" r="5" fill="#60a5fa">
                    <animate
                      attributeName="r"
                      values="5;6;5"
                      dur="1.5s"
                      repeatCount="indefinite"
                    />
                  </circle>

                  <!-- AÄŸÄ±z -->
                  <path
                    d="M 48 47 Q 60 52 72 47"
                    stroke="#ff6b00"
                    stroke-width="2"
                    fill="none"
                    stroke-linecap="round"
                  />

                  <!-- Kollar -->
                  <rect
                    x="18"
                    y="60"
                    width="12"
                    height="30"
                    rx="6"
                    fill="url(#robotGradient)"
                  />
                  <rect
                    x="90"
                    y="60"
                    width="12"
                    height="30"
                    rx="6"
                    fill="url(#robotGradient)"
                  />

                  <!-- Eller -->
                  <circle cx="24" cy="92" r="6" fill="#ff8c00">
                    <animateTransform
                      attributeName="transform"
                      type="rotate"
                      values="0 24 92;15 24 92;0 24 92"
                      dur="2s"
                      repeatCount="indefinite"
                    />
                  </circle>
                  <circle cx="96" cy="92" r="6" fill="#ff8c00">
                    <animateTransform
                      attributeName="transform"
                      type="rotate"
                      values="0 96 92;-15 96 92;0 96 92"
                      dur="2s"
                      repeatCount="indefinite"
                    />
                  </circle>

                  <!-- Gradients -->
                  <defs>
                    <linearGradient
                      id="robotGradient"
                      x1="0%"
                      y1="0%"
                      x2="100%"
                      y2="100%"
                    >
                      <stop
                        offset="0%"
                        style="stop-color: #ff8c00; stop-opacity: 1"
                      />
                      <stop
                        offset="100%"
                        style="stop-color: #ff4500; stop-opacity: 1"
                      />
                    </linearGradient>
                  </defs>
                </svg>
              </div>
              <h3 style="margin: 0 0 8px 0; color: var(--text-primary)">
                AkÄ±llÄ± Asistan ile BaÅŸlayÄ±n
              </h3>
              <p style="margin: 0; color: var(--text-secondary)">
                "AkÄ±llÄ± Asistan" butonuna tÄ±klayarak okul bilgilerinizi girin
              </p>
            </div>
          </div>
        </div>

        <!-- SAÄ PANEL: Alternatifler ve Analiz -->
<div class="program-sidebar">
  <!-- SINIF-DERS-Ã–ÄRETMEN ATAMA -->
  <div class="sidebar-section">
    <button
      class="btn-atama-modern"
      id="btnAtamaAc"
      onclick="openAtamaModal()"
    >
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
        <line x1="9" y1="3" x2="9" y2="21"/>
        <line x1="3" y1="9" x2="21" y2="9"/>
        <line x1="3" y1="15" x2="21" y2="15"/>
      </svg>
      <div class="btn-atama-text">
        <div class="btn-atama-title">ğŸ“š SÄ±nÄ±f-Ders-Ã–ÄŸretmen</div>
        <div class="btn-atama-subtitle">Atama EkranÄ±</div>
      </div>
    </button>
  </div>

 <!-- âœ… YAPILAN ATAMALAR AKORDÄ°YON (KAYDIRMA YOK) -->
<div class="sidebar-section">
  <div class="accordion-header" id="atamaListesiAccordion">
    <div class="accordion-title">
      <span>ğŸ“‹</span>
      <span>YAPILAN ATAMALAR</span>
    </div>
    <div class="accordion-icon">â–¶</div>
  </div>
  <div class="accordion-content" id="atamaListesiContent">
    <div id="atamaListesiContainer">
      <div class="empty-message">HenÃ¼z atama yapÄ±lmadÄ±</div>
    </div>
  </div>
</div>

  <!-- AI Ã–nerileri -->
  <div class="sidebar-section">
    <h3 class="section-title">ğŸ’¡ AI Ã–nerileri</h3>
    <div class="oneri-list" id="oneriList">
      <div class="oneri-item oneri-bilgi">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="16" x2="12" y2="12" />
          <line x1="12" y1="8" x2="12.01" y2="8" />
        </svg>
        <div>
          <strong>HoÅŸ Geldiniz!</strong>
          <p>AkÄ±llÄ± asistan size yol gÃ¶sterecek</p>
        </div>
      </div>
    </div>
  </div>

  <!-- KÄ±sÄ±tlar ve Tercihler -->
  <div class="sidebar-section">
    <h3 class="section-title">âš™ï¸ Ayarlar</h3>

    <!-- KÄ±sÄ±tlar Butonu -->
    <button class="btn-secondary" style="width: 100%; margin-bottom: 8px" id="btnKisitAc">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z" />
        <path d="M2 17l10 5 10-5M2 12l10 5 10-5" />
      </svg>
      <span>KÄ±sÄ±tlar</span>
    </button>

    <!-- Ã–ÄŸretmen Tercihleri Butonu -->
    <button class="btn-secondary" id="btnTercihAc" style="width: 100%;">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
        <circle cx="12" cy="7" r="4" />
      </svg>
      <span>Ã–ÄŸretmen Tercihleri</span>
    </button>
  </div>
</div>

    <!-- AKILLI ASÄ°STAN MODAL -->
<div class="modal-overlay" id="modalAsistan" style="display: none">
  <div class="modal-container" style="max-width: 800px">
    <div class="modal-header">
      <h2>
        <span style="font-size: 28px; margin-right: 8px">ğŸ¤–</span>
        <span>AkÄ±llÄ± Asistan</span>
      </h2>
      <button class="modal-close" onclick="closeModal('modalAsistan')">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Step Ä°ndikatÃ¶rÃ¼ -->
    <div class="asistan-steps" id="asistanSteps">
      <div class="asistan-step active" data-step="1">
        <span class="step-number">1</span>
        <span class="step-label">HoÅŸ Geldiniz</span>
      </div>
      <div class="asistan-step" data-step="2">
        <span class="step-number">2</span>
        <span class="step-label">Okul Bilgileri</span>
      </div>
      <div class="asistan-step" data-step="3">
        <span class="step-number">3</span>
        <span class="step-label">Ders Saatleri</span>
      </div>
      <div class="asistan-step" data-step="4">
        <span class="step-number">4</span>
        <span class="step-label">TamamlandÄ±</span>
      </div>
    </div>

    <div class="modal-body">
      <form id="formAsistan">
        <!-- STEP 1: HoÅŸ Geldiniz -->
        <div class="asistan-content" data-step="1" style="display: block;">
          <div class="welcome-screen">
            <div
              style="
                font-size: 64px;
                text-align: center;
                margin-bottom: 24px;
              "
            >
              ğŸ“
            </div>
            <h2
              style="
                text-align: center;
                margin: 0 0 16px 0;
                color: #1a1a1a;
              "
            >
              HoÅŸ Geldiniz!
            </h2>
            <p
              style="
                text-align: center;
                color: #666;
                font-size: 16px;
                line-height: 1.6;
              "
            >
              AkÄ±llÄ± program oluÅŸturucu size yardÄ±mcÄ± olacak. <br />
              Ã–nce okulunuzun temel bilgilerini girmeniz gerekiyor. <br />
              Bu bilgiler sayesinde size Ã¶zel bir program tablosu
              oluÅŸturulacak.
            </p>
            <div class="info-box" style="margin-top: 24px; background: #e3f2fd; padding: 16px; border-radius: 8px; display: flex; gap: 12px; align-items: flex-start;">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="#2196f3"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10" />
                <line x1="12" y1="16" x2="12" y2="12" />
                <line x1="12" y1="8" x2="12.01" y2="8" />
              </svg>
              <div>
                <strong style="color: #1a1a1a;">Bilgi:</strong> 
                <span style="color: #666;">Bu iÅŸlem sadece bir kez yapÄ±lÄ±r. SonrasÄ±nda istediÄŸiniz zaman deÄŸiÅŸtirebilirsiniz.</span>
              </div>
            </div>
          </div>
        </div>

        <!-- STEP 2: Okul Bilgileri -->
        <div class="asistan-content" data-step="2" style="display: none;">
          <h3 style="margin: 0 0 20px 0; color: #1a1a1a;">
            ğŸ“… Okul Bilgileri
          </h3>

          <div class="form-grid" style="display: grid; gap: 20px;">
            <div class="form-group full-width">
              <label class="form-label required" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                Hafta KaÃ§ GÃ¼n Ders YapÄ±yorsunuz?
              </label>
              <div class="radio-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <label class="radio-card" style="border: 2px solid #e0e0e0; padding: 16px; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                  <input type="radio" name="haftaGunu" value="5" checked style="margin-right: 8px;" />
                  <div class="radio-content">
                    <span style="font-size: 24px">5ï¸âƒ£</span>
                    <span style="color: #1a1a1a; font-weight: 600;">5 GÃ¼n (Pzt-Cum)</span>
                  </div>
                </label>
                <label class="radio-card" style="border: 2px solid #e0e0e0; padding: 16px; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                  <input type="radio" name="haftaGunu" value="6" style="margin-right: 8px;" />
                  <div class="radio-content">
                    <span style="font-size: 24px">6ï¸âƒ£</span>
                    <span style="color: #1a1a1a; font-weight: 600;">6 GÃ¼n (Pzt-Cmt)</span>
                  </div>
                </label>
              </div>
            </div>

            <div class="form-group full-width">
              <label class="form-label required" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                GÃ¼nlÃ¼k Ders DaÄŸÄ±lÄ±mÄ±
              </label>
              <div class="radio-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <label class="radio-card" style="border: 2px solid #e0e0e0; padding: 16px; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                  <input type="radio" name="gunlukDers" value="sabit" checked style="margin-right: 8px;" />
                  <div class="radio-content">
                    <span style="color: #1a1a1a; font-weight: 600;">Sabit (Her gÃ¼n aynÄ±)</span>
                  </div>
                </label>
                <label class="radio-card" style="border: 2px solid #e0e0e0; padding: 16px; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                  <input type="radio" name="gunlukDers" value="farkli" style="margin-right: 8px;" />
                  <div class="radio-content">
                    <span style="color: #1a1a1a; font-weight: 600;">FarklÄ± (GÃ¼nlere gÃ¶re)</span>
                  </div>
                </label>
              </div>
            </div>

            <!-- GÃœNDE KAÃ‡ DERS -->
            <div class="form-group full-width" id="sabitDersGroup">
              <label class="form-label required" style="color: #1a1a1a; font-weight: 600; text-align: center; display: block; margin-bottom: 12px; font-size: 15px;">
                GÃœNDE KAÃ‡ DERS?
              </label>

              <div class="number-select modern" style="display: flex; align-items: center; justify-content: center; gap: 16px; background: #f5f5f5; padding: 16px; border-radius: 12px; max-width: 280px; margin: 0 auto;">
                <button
                  type="button"
                  class="number-btn-decrease"
                  style="background: #607d8b; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 22px; cursor: pointer; transition: all 0.2s; font-weight: bold;"
                >
                  âˆ’
                </button>

                <input
                  type="number"
                  id="sabitDersSayisi"
                  class="number-input"
                  value="8"
                  min="4"
                  max="10"
                  style="width: 70px; text-align: center; background: white; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a; font-size: 20px; font-weight: bold; padding: 8px; outline: none;"
                />

                <button
                  type="button"
                  class="number-btn-increase"
                  style="background: #607d8b; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 22px; cursor: pointer; transition: all 0.2s; font-weight: bold;"
                >
                  +
                </button>
              </div>

              <small class="form-hint" style="color: #666; text-align: center; display: block; margin-top: 10px; font-size: 13px;">
                4 ile 10 arasÄ±nda bir deÄŸer seÃ§in
              </small>
            </div>

            <!-- FarklÄ± gÃ¼nlÃ¼k ders (gizli) -->
            <div class="form-group full-width" id="farkliDersGroup" style="display: none;">
              <label class="form-label required" style="color: #1a1a1a; font-weight: 600; margin-bottom: 12px; display: block;">
                Her GÃ¼n Ä°Ã§in Ders SayÄ±sÄ±
              </label>
              <div style="display: grid; gap: 12px;">
                <div style="display: flex; gap: 12px; align-items: center;">
                  <span style="width: 100px; color: #1a1a1a; font-weight: 600;">Pazartesi:</span>
                  <input type="number" class="form-input" id="pazartesiDers" value="8" min="4" max="10" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a;" />
                </div>
                <div style="display: flex; gap: 12px; align-items: center;">
                  <span style="width: 100px; color: #1a1a1a; font-weight: 600;">SalÄ±:</span>
                  <input type="number" class="form-input" id="saliDers" value="8" min="4" max="10" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a;" />
                </div>
                <div style="display: flex; gap: 12px; align-items: center;">
                  <span style="width: 100px; color: #1a1a1a; font-weight: 600;">Ã‡arÅŸamba:</span>
                  <input type="number" class="form-input" id="carsambaDers" value="8" min="4" max="10" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a;" />
                </div>
                <div style="display: flex; gap: 12px; align-items: center;">
                  <span style="width: 100px; color: #1a1a1a; font-weight: 600;">PerÅŸembe:</span>
                  <input type="number" class="form-input" id="persembeDers" value="8" min="4" max="10" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a;" />
                </div>
                <div style="display: flex; gap: 12px; align-items: center;">
                  <span style="width: 100px; color: #1a1a1a; font-weight: 600;">Cuma:</span>
                  <input type="number" class="form-input" id="cumaDers" value="6" min="4" max="10" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a;" />
                </div>
                <div style="display: none; gap: 12px; align-items: center;" id="cumartesiRow">
                  <span style="width: 100px; color: #1a1a1a; font-weight: 600;">Cumartesi:</span>
                  <input type="number" class="form-input" id="cumartesiDers" value="6" min="4" max="10" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a;" />
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- STEP 3: Ders Saatleri -->
        <div class="asistan-content" data-step="3" style="display: none;">
          <h3 style="margin: 0 0 20px 0; color: #1a1a1a;">
            â° Ders Saatleri ve Molalar
          </h3>

          <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div class="form-group">
              <label class="form-label required" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                Ders BaÅŸlangÄ±Ã§ Saati
              </label>
              <input type="time" id="dersBaslangic" class="form-input" value="08:00" required style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a; font-size: 14px;" />
            </div>

            <div class="form-group">
              <label class="form-label required" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                Ders SÃ¼resi (dakika)
              </label>
              <input type="number" id="dersSuresi" class="form-input" value="40" min="30" max="60" required style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a; font-size: 14px;" />
            </div>

            <div class="form-group">
              <label class="form-label required" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                TeneffÃ¼s SÃ¼resi (dakika)
              </label>
              <input type="number" id="teneffusSuresi" class="form-input" value="10" min="5" max="20" required style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a; font-size: 14px;" />
            </div>

            <div class="form-group">
              <label class="form-label" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                Ã–ÄŸle ArasÄ± Var mÄ±?
              </label>
              <select id="ogleArasi" class="form-select" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a; font-size: 14px;">
                <option value="0">Yok</option>
                <option value="1">Var</option>
              </select>
            </div>

            <div class="form-group full-width" id="ogleArasiDetay" style="display: none; grid-column: 1 / -1;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <div>
                  <label class="form-label" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                    Hangi Dersten Sonra?
                  </label>
                  <input type="number" id="ogleArasiDers" class="form-input" value="4" min="1" max="8" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a; font-size: 14px;" />
                </div>
                <div>
                  <label class="form-label" style="color: #1a1a1a; font-weight: 600; margin-bottom: 8px; display: block;">
                    Ã–ÄŸle ArasÄ± SÃ¼resi (dakika)
                  </label>
                  <input type="number" id="ogleArasiSure" class="form-input" value="60" min="30" max="120" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; color: #1a1a1a; font-size: 14px;" />
                </div>
              </div>
            </div>
          </div>

          <div class="info-box" style="margin-top: 20px; background: #e3f2fd; padding: 16px; border-radius: 8px; display: flex; gap: 12px; align-items: flex-start;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#2196f3" stroke-width="2">
              <circle cx="12" cy="12" r="10" />
              <line x1="12" y1="16" x2="12" y2="12" />
              <line x1="12" y1="8" x2="12.01" y2="8" />
            </svg>
            <div>
              <strong style="color: #1a1a1a;">Ã–nizleme:</strong>
              <span id="saatOnizleme" style="color: #666;">1. Ders: 08:00-08:40</span>
            </div>
          </div>
        </div>

        <!-- STEP 4: TamamlandÄ± -->
        <div class="asistan-content" data-step="4" style="display: none;">
          <div class="welcome-screen">
            <div style="font-size: 64px; text-align: center; margin-bottom: 24px;">
              âœ…
            </div>
            <h2 style="text-align: center; margin: 0 0 16px 0; color: #1a1a1a;">
              Harika! TamamlandÄ±
            </h2>
            <p style="text-align: center; color: #666; font-size: 16px; line-height: 1.6; margin-bottom: 24px;">
              Okul bilgileriniz kaydedildi. <br />
              Åimdi program tablosunu oluÅŸturuyorum...
            </p>
            <div class="success-summary" id="successSummary">
              <!-- JavaScript ile doldurulacak -->
            </div>
          </div>
        </div>

        <!-- Navigasyon ButonlarÄ± -->
        <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid #e0e0e0; display: flex; justify-content: flex-end; gap: 12px;">
          <button type="button" class="btn-secondary" id="btnAsistanGeri" style="display: none; padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 8px; cursor: pointer;">
            â† Geri
          </button>
          <button type="button" class="btn-secondary" id="btnAsistanIptal" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 8px; cursor: pointer;">
            Ä°ptal
          </button>
          <button type="button" class="btn-primary" id="btnAsistanIleri" style="padding: 10px 20px; background: #4a90e2; color: white; border: none; border-radius: 8px; cursor: pointer;">
            Ä°leri â†’
          </button>
          <button type="button" class="btn-primary" id="btnAsistanTamamla" style="display: none; padding: 10px 20px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer;">
            Tamamla ve BaÅŸlat
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// ============================================
// AKILLI ASÄ°STAN WIZARD KONTROL
// ============================================
(function() {
  let currentStep = 1;
  const totalSteps = 4;

  // Ä°leri butonu
  const btnIleri = document.getElementById('btnAsistanIleri');
  if (btnIleri) {
    btnIleri.addEventListener('click', function() {
      console.log('Ä°leri butonuna tÄ±klandÄ±, mevcut adÄ±m:', currentStep);
      if (currentStep < totalSteps) {
        currentStep++;
        updateWizardUI();
      }
    });
  }

  // Geri butonu
  const btnGeri = document.getElementById('btnAsistanGeri');
  if (btnGeri) {
    btnGeri.addEventListener('click', function() {
      console.log('Geri butonuna tÄ±klandÄ±, mevcut adÄ±m:', currentStep);
      if (currentStep > 1) {
        currentStep--;
        updateWizardUI();
      }
    });
  }

  // Ä°ptal butonu
  const btnIptal = document.getElementById('btnAsistanIptal');
  if (btnIptal) {
    btnIptal.addEventListener('click', function() {
      closeModal('modalAsistan');
      currentStep = 1;
      updateWizardUI();
    });
  }

  // âœ… TAMAMLA VE BAÅLAT BUTONU
  const btnTamamla = document.getElementById('btnAsistanTamamla');
  if (btnTamamla) {
    btnTamamla.addEventListener('click', async function() {
      console.log('ğŸ¯ Tamamla ve BaÅŸlat butonuna tÄ±klandÄ±');
      
      try {
        // 1. Form verilerini topla
        const haftaGunu = parseInt(document.querySelector('input[name="haftaGunu"]:checked').value);
        const gunlukDersTip = document.querySelector('input[name="gunlukDers"]:checked').value;
        const sabitDersSayisi = parseInt(document.getElementById('sabitDersSayisi').value);
        const dersBaslangic = document.getElementById('dersBaslangic').value;
        const dersSuresi = parseInt(document.getElementById('dersSuresi').value);
        const teneffusSuresi = parseInt(document.getElementById('teneffusSuresi').value);
        const ogleArasiVar = document.getElementById('ogleArasi').value === '1';
        
        console.log('ğŸ“Š Form verileri:', {
          haftaGunu,
          gunlukDersTip,
          sabitDersSayisi,
          dersBaslangic,
          dersSuresi,
          teneffusSuresi,
          ogleArasiVar
        });

        // 2. Ã–zet oluÅŸtur
        const successSummary = document.getElementById('successSummary');
        if (successSummary) {
          const gunler = haftaGunu === 5 ? 'Pazartesi-Cuma' : 'Pazartesi-Cumartesi';
          successSummary.innerHTML = `
            <div style="background: #e8f5e9; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
              <strong style="color: #1a1a1a;">ğŸ“… Hafta:</strong>
              <span style="color: #666;">${gunler} (${haftaGunu} gÃ¼n)</span>
            </div>
            <div style="background: #e8f5e9; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
              <strong style="color: #1a1a1a;">ğŸ“š GÃ¼nlÃ¼k Ders:</strong>
              <span style="color: #666;">${sabitDersSayisi} saat/gÃ¼n</span>
            </div>
            <div style="background: #e8f5e9; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
              <strong style="color: #1a1a1a;">â° BaÅŸlangÄ±Ã§:</strong>
              <span style="color: #666;">${dersBaslangic}</span>
            </div>
            <div style="background: #e8f5e9; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
              <strong style="color: #1a1a1a;">â±ï¸ Ders SÃ¼resi:</strong>
              <span style="color: #666;">${dersSuresi} dakika</span>
            </div>
            <div style="background: #e8f5e9; padding: 16px; border-radius: 8px;">
              <strong style="color: #1a1a1a;">ğŸ”” TeneffÃ¼s:</strong>
              <span style="color: #666;">${teneffusSuresi} dakika</span>
            </div>
          `;
        }

        // 3. Bildirim gÃ¶ster
        if (typeof ModernBildirim !== 'undefined') {
          ModernBildirim.info('Ä°ÅŸleniyor', 'Program oluÅŸturuluyor...');
        }

        // 4. VeritabanÄ±na kaydet
        const programData = {
          sinif_id: 1, // GeÃ§ici
          program_adi: `Program ${new Date().toLocaleDateString('tr-TR')}`,
          hafta_gunu: haftaGunu,
          gunluk_ders_sayisi: sabitDersSayisi,
          ders_suresi: dersSuresi,
          teneffus_suresi: teneffusSuresi,
          baslangic_saati: dersBaslangic,
          ogle_arasi_var: ogleArasiVar ? 1 : 0,
          ogle_arasi_ders_sonrasi: ogleArasiVar ? parseInt(document.getElementById('ogleArasiDers').value) : 0,
          ogle_arasi_suresi: ogleArasiVar ? parseInt(document.getElementById('ogleArasiSure').value) : 0,
          olusturan_kullanici_id: null,
          notlar: 'AkÄ±llÄ± Asistan ile oluÅŸturuldu'
        };

        console.log('ğŸ“¤ Program data gÃ¶nderiliyor:', programData);

       // 5. API Ã§aÄŸrÄ±sÄ± (eÄŸer varsa)
if (typeof window.electronAPI !== 'undefined' && window.electronAPI.createDersProgram) {
  const result = await window.electronAPI.createDersProgram(programData);
  
  console.log('ğŸ“¥ API yanÄ±tÄ±:', result);
  
  if (result.success) {
    console.log('âœ… Program oluÅŸturuldu baÅŸarÄ±yla!');
    
    // Program ID'sini gÃ¼venli ÅŸekilde al
    const programId = result.data?.program_id || result.programId || result.id;
    
    if (programId) {
      console.log('âœ… Program ID:', programId);
      
      // LocalStorage'a kaydet
      localStorage.setItem('currentProgramId', programId.toString());
      localStorage.setItem('programConfig', JSON.stringify(programData));
      
      // BaÅŸarÄ± bildirimi
      if (typeof ModernBildirim !== 'undefined') {
        ModernBildirim.success('BaÅŸarÄ±lÄ±!', 'Program oluÅŸturuldu! ID: ' + programId);
      }
      
      // 2 saniye sonra modalÄ± kapat ve tabloyu oluÅŸtur
      setTimeout(() => {
        closeModal('modalAsistan');
        currentStep = 1;
        updateWizardUI();
        
        // Program tablosunu oluÅŸtur
        if (typeof createProgramTable !== 'undefined') {
          createProgramTable();
        }
      }, 2000);
      
    } else {
      console.warn('âš ï¸ Program ID bulunamadÄ± ama baÅŸarÄ±lÄ±:', result);
      
      if (typeof ModernBildirim !== 'undefined') {
        ModernBildirim.success('BaÅŸarÄ±lÄ±!', 'Program oluÅŸturuldu!');
      }
      
      setTimeout(() => {
        closeModal('modalAsistan');
        currentStep = 1;
        updateWizardUI();
      }, 2000);
    }
    
  } else {
    console.error('âŒ Program oluÅŸturulamadÄ±:', result.message);
    if (typeof ModernBildirim !== 'undefined') {
      ModernBildirim.error('Hata', result.message || 'Program oluÅŸturulamadÄ±!');
    }
  }
} else {
  console.warn('âš ï¸ electronAPI bulunamadÄ±');
  
  // Yine de modalÄ± kapat
  setTimeout(() => {
    closeModal('modalAsistan');
    currentStep = 1;
    updateWizardUI();
  }, 2000);
}

      } catch (error) {
        console.error('âŒ Tamamla hatasÄ±:', error);
        if (typeof ModernBildirim !== 'undefined') {
          ModernBildirim.error('Hata', 'Program oluÅŸturulurken hata oluÅŸtu!');
        }
      }
    });
  }

  // +/- butonlarÄ±
  const btnDecrease = document.querySelector('.number-btn-decrease');
  const btnIncrease = document.querySelector('.number-btn-increase');
  const inputSaat = document.getElementById('sabitDersSayisi');

  if (btnDecrease && inputSaat) {
    btnDecrease.addEventListener('click', function() {
      const val = parseInt(inputSaat.value) || 8;
      if (val > 4) inputSaat.value = val - 1;
    });
  }

  if (btnIncrease && inputSaat) {
    btnIncrease.addEventListener('click', function() {
      const val = parseInt(inputSaat.value) || 8;
      if (val < 10) inputSaat.value = val + 1;
    });
  }

  // Ã–ÄŸle arasÄ± toggle
  const ogleArasi = document.getElementById('ogleArasi');
  if (ogleArasi) {
    ogleArasi.addEventListener('change', function() {
      const detay = document.getElementById('ogleArasiDetay');
      if (detay) {
        detay.style.display = this.value === '1' ? 'block' : 'none';
      }
    });
  }

  // UI GÃ¼ncelleme
  function updateWizardUI() {
    console.log('UI gÃ¼ncelleniyor, adÄ±m:', currentStep);

    // AdÄ±m gÃ¶stergesini gÃ¼ncelle
    const steps = document.querySelectorAll('.asistan-step');
    steps.forEach((step, index) => {
      if (index + 1 < currentStep) {
        step.classList.add('completed');
        step.classList.remove('active');
      } else if (index + 1 === currentStep) {
        step.classList.add('active');
        step.classList.remove('completed');
      } else {
        step.classList.remove('active', 'completed');
      }
    });

    // Ä°Ã§erikleri gÃ¶ster/gizle
    const contents = document.querySelectorAll('.asistan-content');
    contents.forEach((content, index) => {
      content.style.display = (index + 1) === currentStep ? 'block' : 'none';
    });

    // ButonlarÄ± gÃ¼ncelle
    const btnGeri = document.getElementById('btnAsistanGeri');
    const btnIleri = document.getElementById('btnAsistanIleri');
    const btnTamamla = document.getElementById('btnAsistanTamamla');
    const btnIptal = document.getElementById('btnAsistanIptal');

    if (btnGeri) btnGeri.style.display = currentStep === 1 ? 'none' : 'inline-block';
    if (btnIleri) btnIleri.style.display = currentStep === totalSteps ? 'none' : 'inline-block';
    if (btnTamamla) btnTamamla.style.display = currentStep === totalSteps ? 'inline-block' : 'none';
    if (btnIptal) btnIptal.style.display = currentStep === totalSteps ? 'none' : 'inline-block';
  }

  console.log('âœ… AkÄ±llÄ± Asistan wizard kontrol yÃ¼klendi');
})();
</script>
    <!-- ==========================================
         ğŸ¯ KISIT YÃ–NETÄ°MÄ° MODALI
         ========================================== -->
    <div id="kisitModal" class="modal-overlay" style="display: none;">
      <div class="modal-container modal-large">
        <!-- Modal Header -->
        <div class="modal-header">
          <div class="modal-header-left">
            <div class="modal-icon gradient-orange">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M12 2L2 7l10 5 10-5-10-5z" />
                <path d="M2 17l10 5 10-5M2 12l10 5 10-5" />
              </svg>
            </div>
            <div>
              <h2 class="modal-title">ğŸ¯ KÄ±sÄ±t YÃ¶netimi</h2>
              <p class="modal-subtitle">Ders daÄŸÄ±tÄ±m kurallarÄ±nÄ± belirleyin</p>
            </div>
          </div>
          <button class="modal-close" id="btnKisitKapat">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>

<!-- TAB MENÃœSÃœ -->
        <div class="modal-tabs">
          <button class="modal-tab active" data-tab="genel">
            <span class="modal-tab-icon">ğŸ“Š</span>
            <span>Genel Ayarlar</span>
          </button>
          <button class="modal-tab" data-tab="ogretmen">
            <span class="modal-tab-icon">ğŸ‘¨â€ğŸ«</span>
            <span>Ã–ÄŸretmen BazlÄ±</span>
          </button>
          <button class="modal-tab" data-tab="blok">
            <span class="modal-tab-icon">ğŸ²</span>
            <span>AkÄ±llÄ± Blok</span>
          </button>
          <button class="modal-tab" data-tab="onizleme">
            <span class="modal-tab-icon">ğŸ‘ï¸</span>
            <span>Ã–nizleme</span>
          </button>
        </div>

        <!-- Modal Body -->
        <div class="modal-body">
          <!-- TAB 1: GENEL AYARLAR -->
          <div id="tab-genel" class="tab-content active">
          <!-- GENEL KISITLAR -->
          <div class="kisit-section">
            <div class="kisit-section-header">
              <h3>ğŸ“Š GENEL KISITLAR</h3>
              <span class="kisit-badge">TÃ¼m Ã¶ÄŸretmenlere uygulanÄ±r</span>
            </div>

            <div class="kisit-card">
              <!-- TÃ¼m Ã–ÄŸretmenlere Uygula -->
              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="chkTumOgretmenlere" checked />
                  <span class="checkbox-custom"></span>
                  <span class="checkbox-text">TÃ¼m Ã¶ÄŸretmenlere uygula</span>
                </label>
                <p class="form-help">
                  Ä°ÅŸaretliyseniz, tÃ¼m Ã¶ÄŸretmenler iÃ§in aynÄ± kural geÃ§erli olur
                </p>
              </div>

              <!-- GÃ¼nlÃ¼k Ders AralÄ±ÄŸÄ± -->
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label">En Az GÃ¼nlÃ¼k Ders</label>
                  <select id="selectMinGunlukDers" class="form-select">
                    <option value="2" selected>2 saat</option>
                    <option value="3">3 saat</option>
                    <option value="4">4 saat</option>
                  </select>
                </div>

                <div class="form-group">
                  <label class="form-label">En Ã‡ok GÃ¼nlÃ¼k Ders</label>
                  <select id="selectMaxGunlukDers" class="form-select">
                    <option value="6">6 saat</option>
                    <option value="7">7 saat</option>
                    <option value="8" selected>8 saat</option>
                  </select>
                </div>
              </div>

              <!-- Tek Saat Yasak UyarÄ±sÄ± -->
              <div class="kisit-warning">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"
                  />
                  <line x1="12" y1="9" x2="12" y2="13" />
                  <line x1="12" y1="17" x2="12.01" y2="17" />
                </svg>
                <span>âš ï¸ ASLA gÃ¼nde 1 saat ders olmayacak</span>
              </div>

              <!-- BoÅŸ Pencere -->
              <div class="form-group">
                <label class="form-label">Maksimum BoÅŸ Pencere</label>
                <select id="selectMaxBosPencere" class="form-select">
                  <option value="1">1 boÅŸ pencere</option>
                  <option value="2" selected>2 boÅŸ pencere</option>
                  <option value="3">3 boÅŸ pencere</option>
                </select>
                <p class="form-help">
                  Ã–ÄŸretmenin gÃ¼nlÃ¼k programÄ±nda en fazla kaÃ§ boÅŸ ders saati
                  olabilir
                </p>
              </div>
            </div>
          </div>
</div>
          <!-- TAB 2: Ã–ÄRETMEN BAZLI -->
          <div id="tab-ogretmen" class="tab-content">
          <!-- Ã–ÄRETMEN BAZLI KISITLAR -->
          <div class="kisit-section">
            <div class="kisit-section-header">
              <h3>ğŸ‘¨â€ğŸ« Ã–ÄRETMEN BAZLI KISITLAR</h3>
              <span class="kisit-badge kisit-badge-blue">Bireysel ayarlar</span>
            </div>

            <div class="kisit-card">
              <!-- Ã–ÄŸretmen KartlarÄ± -->
              <div class="form-label">Ã–ÄŸretmen SeÃ§in (Karta TÄ±klayÄ±n)</div>
              <div class="ogretmen-card-list" id="ogretmenCardList">
                <!-- JavaScript ile doldurulacak -->
              </div>

              <!-- SeÃ§ili Ã–ÄŸretmen Bilgisi -->
              <div
                id="secilenOgretmenInfo"
                class="secilen-ogretmen-info"
                style="display: none"
              >
                <div class="info-badge">
                  <span class="info-label">âœ… SeÃ§ili Ã–ÄŸretmen:</span>
                  <span class="info-value" id="secilenOgretmenAd"></span>
                  <button
                    class="btn-clear-selection"
                    onclick="clearOgretmenSelection()"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>

              <!-- KÄ±sÄ±t AyarlarÄ± (SeÃ§im yapÄ±nca gÃ¶rÃ¼necek) -->
              <div
                class="form-row"
                id="kisitAyarlari"
                style="display: none; margin-top: 15px"
              >
                <div class="form-group">
                  <label class="form-label">En Az GÃ¼nlÃ¼k Ders</label>
                  <select id="selectOgretmenMin" class="form-select">
                    <option value="">-- SeÃ§in --</option>
                    <option value="2">2 saat</option>
                    <option value="3">3 saat</option>
                    <option value="4">4 saat</option>
                    <option value="5">5 saat</option>
                    <option value="6">6 saat</option>
                  </select>
                </div>

                <div class="form-group">
                  <label class="form-label">En Ã‡ok GÃ¼nlÃ¼k Ders</label>
                  <select id="selectOgretmenMax" class="form-select">
                    <option value="">-- SeÃ§in --</option>
                    <option value="4">4 saat</option>
                    <option value="5">5 saat</option>
                    <option value="6">6 saat</option>
                    <option value="7">7 saat</option>
                    <option value="8">8 saat</option>
                  </select>
                </div>

                <div class="form-group">
                  <label class="form-label">Max BoÅŸ Pencere</label>
                  <select id="selectOgretmenBos" class="form-select">
                    <option value="">-- SeÃ§in --</option>
                    <option value="0">Yok</option>
                    <option value="1">1 saat</option>
                    <option value="2">2 saat</option>
                    <option value="3">3 saat</option>
                  </select>
                </div>
              </div>

              <!-- Butonlar (SeÃ§im yapÄ±nca gÃ¶rÃ¼necek) -->
              <div
                class="form-actions-inline"
                id="kisitButtons"
                style="display: none; margin-top: 15px"
              >
                <button class="btn btn-primary" onclick="addOgretmenKisit()">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M12 5v14M5 12h14" />
                  </svg>
                  KÄ±sÄ±t Ekle
                </button>
                <button
                  class="btn btn-ghost"
                  onclick="clearOgretmenSelection()"
                >
                  Ä°ptal
                </button>
              </div>

              <!-- KayÄ±tlÄ± KÄ±sÄ±tlar Listesi -->
              <div class="kisit-list-header" style="margin-top: 25px">
                <h4>ğŸ“Œ KayÄ±tlÄ± KiÅŸisel KÄ±sÄ±tlar</h4>
              </div>
              <div id="kisitListesi" class="kisit-list">
                <div class="empty-state">
                  <svg
                    width="48"
                    height="48"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1.5"
                  >
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 16v-4M12 8h.01" />
                  </svg>
                  <p>HenÃ¼z Ã¶ÄŸretmen kÄ±sÄ±tÄ± eklenmedi</p>
                </div>
              </div>
            </div>
          </div>
</div>
          <!-- TAB 3: AKILLI BLOK -->
          <div id="tab-blok" class="tab-content">
          <!-- AKILLI BLOK KISITLARI -->
          <div class="kisit-section">
            <div class="kisit-section-header">
              <h3>ğŸ² AKILLI BLOK KISITLARI</h3>
              <span class="kisit-badge kisit-badge-green"
                >Otomatik daÄŸÄ±tÄ±m</span
              >
            </div>

            <div class="kisit-card">
              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="chkAyniGunYasak" checked />
                  <span class="checkbox-custom"></span>
                  <span class="checkbox-text"
                    >AynÄ± sÄ±nÄ±fa aynÄ± Ã¶ÄŸretmen arka arkaya ders veremez</span
                  >
                </label>
                <p class="form-help">
                  Ã–rnek: Matematik Ã¶ÄŸretmeni aynÄ± gÃ¼n 9-A'ya 3 saat Ã¼st Ã¼ste
                  giremez
                </p>
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="chkBlokFarkliGun" checked />
                  <span class="checkbox-custom"></span>
                  <span class="checkbox-text"
                    >Bloklar farklÄ± gÃ¼nlere daÄŸÄ±tÄ±lsÄ±n</span
                  >
                </label>
                <p class="form-help">
                  Ã–rnek: 4 saatlik ders â†’ 2+2 ÅŸeklinde farklÄ± gÃ¼nlere
                  yerleÅŸtirilir
                </p>
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="chkFarkliDersAyri" checked />
                  <span class="checkbox-custom"></span>
                  <span class="checkbox-text"
                    >AynÄ± Ã¶ÄŸretmenin aynÄ± sÄ±nÄ±ftaki farklÄ± dersleri farklÄ±
                    gÃ¼nlerde olsun</span
                  >
                </label>
                <p class="form-help">
                  Ã–rnek: X Ã¶ÄŸretmenin 9-A'da hem Matematik hem SeÃ§meli Proje
                  dersi varsa, bunlar aynÄ± gÃ¼ne gelmez
                </p>
              </div>

              <div class="kisit-info">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <path d="M12 16v-4M12 8h.01" />
                </svg>
                <span
                  >Bu kurallar otomatik daÄŸÄ±tÄ±m algoritmasÄ± tarafÄ±ndan dikkate
                  alÄ±nÄ±r</span
                >
              </div>
            </div>
          </div>
        </div>
</div>
          <!-- TAB 4: Ã–NÄ°ZLEME -->
          <div id="tab-onizleme" class="tab-content">
            <div id="onizlemeContent">
              <!-- JavaScript ile doldurulacak -->
            </div>
          </div>
        <!-- Modal Footer -->
        <div class="modal-footer">
          <button class="btn btn-ghost" id="btnKisitIptal">Ä°ptal</button>
          <button class="btn btn-secondary" id="btnKisitVarsayilan">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" />
              <path d="M21 3v5h-5" />
            </svg>
            VarsayÄ±lana DÃ¶n
          </button>
          <button class="btn btn-primary" id="btnKisitKaydet">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
              />
              <polyline points="17 21 17 13 7 13 7 21" />
              <polyline points="7 3 7 8 15 8" />
            </svg>
            Kaydet
          </button>
        </div>
      </div>
    </div>

    <!-- ==========================================
         ğŸ‘¨â€ğŸ« Ã–ÄRETMEN TERCÄ°HLERÄ° MODALI
         ========================================== -->
    <div id="tercihModal" class="modal-overlay" style="display: none;">
      <div class="modal-container modal-large">
        <!-- Modal Header -->
        <div class="modal-header">
          <div class="modal-header-left">
            <div class="modal-icon gradient-blue">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                <circle cx="12" cy="7" r="4" />
              </svg>
            </div>
            <div>
              <h2 class="modal-title">ğŸ‘¨â€ğŸ« Ã–ÄŸretmen Tercihleri</h2>
              <p class="modal-subtitle">
                Ã–ÄŸretmenlerin boÅŸ gÃ¼n ve kapalÄ± saat tercihlerini yÃ¶netin
              </p>
            </div>
          </div>
          <button class="modal-close" id="btnTercihKapat">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>

        <!-- Modal Body -->
        <div class="modal-body">
          <!-- Ã–ÄŸretmen SeÃ§imi -->
          <div class="tercih-section">
            <div class="form-group">
              <label class="form-label">Ã–ÄŸretmen SeÃ§</label>
              <select
                id="selectOgretmenTercih"
                class="form-select form-select-large"
              >
                <option value="">-- Ã–ÄŸretmen SeÃ§in --</option>
              </select>
            </div>
          </div>

          <!-- BoÅŸ GÃ¼n Tercihi -->
          <div class="tercih-section">
            <div class="tercih-section-header">
              <h3>ğŸ“… BOÅ GÃœN TERCÄ°HÄ°</h3>
              <span class="tercih-badge">Hangi gÃ¼n hiÃ§ ders yapmasÄ±n?</span>
            </div>

            <div class="tercih-card">
              <div class="tercih-gun-group">
                <label class="tercih-gun-label">
                  <input type="radio" name="bosGun" value="0" />
                  <span class="tercih-gun-button">
                    <span class="gun-icon">ğŸ“…</span>
                    <span class="gun-text">BoÅŸ GÃ¼n Yok</span>
                  </span>
                </label>

                <label class="tercih-gun-label">
                  <input type="radio" name="bosGun" value="1" />
                  <span class="tercih-gun-button">
                    <span class="gun-icon">1ï¸âƒ£</span>
                    <span class="gun-text">Pazartesi</span>
                  </span>
                </label>

                <label class="tercih-gun-label">
                  <input type="radio" name="bosGun" value="2" />
                  <span class="tercih-gun-button">
                    <span class="gun-icon">2ï¸âƒ£</span>
                    <span class="gun-text">SalÄ±</span>
                  </span>
                </label>

                <label class="tercih-gun-label">
                  <input type="radio" name="bosGun" value="3" />
                  <span class="tercih-gun-button">
                    <span class="gun-icon">3ï¸âƒ£</span>
                    <span class="gun-text">Ã‡arÅŸamba</span>
                  </span>
                </label>

                <label class="tercih-gun-label">
                  <input type="radio" name="bosGun" value="4" />
                  <span class="tercih-gun-button">
                    <span class="gun-icon">4ï¸âƒ£</span>
                    <span class="gun-text">PerÅŸembe</span>
                  </span>
                </label>

                <label class="tercih-gun-label">
                  <input type="radio" name="bosGun" value="5" />
                  <span class="tercih-gun-button">
                    <span class="gun-icon">5ï¸âƒ£</span>
                    <span class="gun-text">Cuma</span>
                  </span>
                </label>
              </div>
            </div>
          </div>

          <!-- KapalÄ± Saatler -->
          <div class="tercih-section">
            <div class="tercih-section-header">
              <h3>â° DERS YAPILAMAYACAK SAATLER</h3>
              <span class="tercih-badge tercih-badge-red"
                >KÄ±rmÄ±zÄ± = KapalÄ±</span
              >
            </div>

            <div class="tercih-card">
              <div class="saat-grid-container">
                <table class="saat-grid" id="saatGrid">
                  <thead>
                    <tr>
                      <th class="saat-header-gun">GÃ¼n</th>
                      <th class="saat-header">1</th>
                      <th class="saat-header">2</th>
                      <th class="saat-header">3</th>
                      <th class="saat-header">4</th>
                      <th class="saat-header">5</th>
                      <th class="saat-header">6</th>
                      <th class="saat-header">7</th>
                      <th class="saat-header">8</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr data-gun="1">
                      <td class="gun-label">Pazartesi</td>
                      <td class="saat-cell" data-saat="1"></td>
                      <td class="saat-cell" data-saat="2"></td>
                      <td class="saat-cell" data-saat="3"></td>
                      <td class="saat-cell" data-saat="4"></td>
                      <td class="saat-cell" data-saat="5"></td>
                      <td class="saat-cell" data-saat="6"></td>
                      <td class="saat-cell" data-saat="7"></td>
                      <td class="saat-cell" data-saat="8"></td>
                    </tr>
                    <tr data-gun="2">
                      <td class="gun-label">SalÄ±</td>
                      <td class="saat-cell" data-saat="1"></td>
                      <td class="saat-cell" data-saat="2"></td>
                      <td class="saat-cell" data-saat="3"></td>
                      <td class="saat-cell" data-saat="4"></td>
                      <td class="saat-cell" data-saat="5"></td>
                      <td class="saat-cell" data-saat="6"></td>
                      <td class="saat-cell" data-saat="7"></td>
                      <td class="saat-cell" data-saat="8"></td>
                    </tr>
                    <tr data-gun="3">
                      <td class="gun-label">Ã‡arÅŸamba</td>
                      <td class="saat-cell" data-saat="1"></td>
                      <td class="saat-cell" data-saat="2"></td>
                      <td class="saat-cell" data-saat="3"></td>
                      <td class="saat-cell" data-saat="4"></td>
                      <td class="saat-cell" data-saat="5"></td>
                      <td class="saat-cell" data-saat="6"></td>
                      <td class="saat-cell" data-saat="7"></td>
                      <td class="saat-cell" data-saat="8"></td>
                    </tr>
                    <tr data-gun="4">
                      <td class="gun-label">PerÅŸembe</td>
                      <td class="saat-cell" data-saat="1"></td>
                      <td class="saat-cell" data-saat="2"></td>
                      <td class="saat-cell" data-saat="3"></td>
                      <td class="saat-cell" data-saat="4"></td>
                      <td class="saat-cell" data-saat="5"></td>
                      <td class="saat-cell" data-saat="6"></td>
                      <td class="saat-cell" data-saat="7"></td>
                      <td class="saat-cell" data-saat="8"></td>
                    </tr>
                    <tr data-gun="5">
                      <td class="gun-label">Cuma</td>
                      <td class="saat-cell" data-saat="1"></td>
                      <td class="saat-cell" data-saat="2"></td>
                      <td class="saat-cell" data-saat="3"></td>
                      <td class="saat-cell" data-saat="4"></td>
                      <td class="saat-cell" data-saat="5"></td>
                      <td class="saat-cell" data-saat="6"></td>
                      <td class="saat-cell" data-saat="7"></td>
                      <td class="saat-cell" data-saat="8"></td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="saat-actions">
                <button class="btn btn-sm btn-ghost" id="btnTumunuSec">
                  TÃ¼mÃ¼nÃ¼ SeÃ§
                </button>
                <button class="btn btn-sm btn-ghost" id="btnTumunuKaldir">
                  TÃ¼mÃ¼nÃ¼ KaldÄ±r
                </button>
              </div>
            </div>
          </div>

          <!-- Yapay Zeka Ã–nerisi -->
          <div
            id="aiOneriContainer"
            class="tercih-section"
            style="display: none"
          >
            <div class="ai-oneri-card">
              <div class="ai-oneri-icon">ğŸ¤–</div>
              <div class="ai-oneri-content">
                <h4>Yapay Zeka Ã–nerisi</h4>
                <p id="aiOneriText">
                  Ã‡arÅŸamba gÃ¼nÃ¼ 8 Ã¶ÄŸretmen boÅŸ istiyor! DaÄŸÄ±tÄ±m zorlaÅŸabilir.
                </p>
                <div class="ai-oneri-actions">
                  <button class="btn btn-sm btn-primary" id="btnOneriUygula">
                    Ã–neriyi Uygula
                  </button>
                  <button class="btn btn-sm btn-ghost" id="btnOneriYokSay">
                    Yok Say
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal Footer -->
        <div class="modal-footer">
          <button class="btn btn-ghost" id="btnTercihIptal">Ä°ptal</button>
          <button class="btn btn-danger" id="btnTercihSil">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="3 6 5 6 21 6" />
              <path
                d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
              />
            </svg>
            Tercihleri Sil
          </button>
          <button class="btn btn-primary" id="btnTercihKaydet">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
              />
              <polyline points="17 21 17 13 7 13 7 21" />
              <polyline points="7 3 7 8 15 8" />
            </svg>
            Kaydet
          </button>
        </div>
      </div>
    </div>

    <!-- ==========================================
     ğŸ“š SINIF-DERS-Ã–ÄRETMEN ATAMA MODALI
     ========================================== -->
<div class="modal" id="atamaModal">
  <div class="modal-content modal-large">
    <!-- Header -->
    <div class="modal-header">
      <h2>ğŸ“š SINIF-DERS-Ã–ÄRETMEN ATAMA</h2>
      <button class="btn-close" onclick="closeAtamaModal()" style="background: rgba(244, 67, 54, 0.2); border: none; color: #f44336; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 24px; font-weight: 900; transition: all 0.2s;">âœ•</button>
    </div>

    <!-- Steps -->
    <div class="atama-steps">
      <div class="atama-step active" data-step="1">
        <div class="step-number">1</div>
        <div class="step-label">HaftalÄ±k Saat</div>
      </div>
      <div class="atama-step" data-step="2">
        <div class="step-number">2</div>
        <div class="step-label">SÄ±nÄ±f SeÃ§</div>
      </div>
      <div class="atama-step" data-step="3">
        <div class="step-number">3</div>
        <div class="step-label">Ders Ata</div>
      </div>
      <div class="atama-step" data-step="4">
        <div class="step-number">4</div>
        <div class="step-label">Ã–ÄŸretmen Ata</div>
      </div>
      <div class="atama-step" data-step="5">
        <div class="step-number">5</div>
        <div class="step-label">Kontrol</div>
      </div>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <!-- ========================================== -->
      <!-- STEP 1: HAFTALIK SAAT -->
      <!-- ========================================== -->
      <div class="atama-content active" data-step="1">
        <h3>ğŸ“… HaftalÄ±k Ders Saati Giriniz</h3>
        
        <div class="form-group">
          <label class="form-label">Bu sÄ±nÄ±f iÃ§in haftalÄ±k toplam ders saati</label>
          <input 
            type="number" 
            id="inputHaftalikSaat" 
            class="form-input" 
            placeholder="Ã–rn: 40" 
            min="1" 
            max="50"
            style="font-size: 24px; text-align: center; font-weight: 900;"
          >
          <p class="form-help" style="color: #666; margin-top: 10px;">
            SÄ±nÄ±fÄ±n toplam haftalÄ±k ders yÃ¼kÃ¼ (genellikle 35-45 saat arasÄ±)
          </p>
        </div>

        <div class="ozet-onay" style="margin-top: 30px;">
          <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#2196f3" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          <p style="margin-top: 16px; color: #666; font-size: 14px;">
            Bu deÄŸer, sÄ±nÄ±fa atanacak toplam ders saatini belirler
          </p>
        </div>
      </div>

      <!-- ========================================== -->
      <!-- STEP 2: SINIF SEÃ‡ -->
      <!-- ========================================== -->
      <div class="atama-content" data-step="2">
        <h3>ğŸ« SÄ±nÄ±f SeÃ§iniz</h3>
        
        <div class="sinif-card-grid" id="sinifCardGrid">
          <!-- JavaScript ile doldurulacak -->
          <div class="empty-message">SÄ±nÄ±flar yÃ¼kleniyor...</div>
        </div>
        
        <div class="kopyalama-section">
          <h4>ğŸ“‹ Ãœst SÄ±nÄ±ftan Kopyala (Opsiyonel)</h4>
          <p style="font-size: 12px; color: #666; margin-bottom: 12px;">
            Daha Ã¶nce atama yaptÄ±ÄŸÄ±nÄ±z bir sÄ±nÄ±ftan kopyalayabilirsiniz
          </p>
          <select id="selectKopyalaSinif" class="form-select" style="margin-bottom: 12px;">
            <option value="">-- Kopyalanacak SÄ±nÄ±f SeÃ§in --</option>
          </select>
          <button class="btn btn-ghost" onclick="kopyalaSiniftan()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            Kopyala
          </button>
        </div>
      </div>

      <!-- ========================================== -->
      <!-- STEP 3: DERS ATA -->
      <!-- ========================================== -->
      <div class="atama-content" data-step="3">
        <h3 id="dersListesiBaslik">SÄ±nÄ±fa Ders AtayÄ±nÄ±z</h3>
        
        <div class="secili-sinif-info">
          <span class="info-label">SeÃ§ili SÄ±nÄ±f:</span>
          <span class="info-value" id="secilenSinifAd">-</span>
          <span class="info-label">HaftalÄ±k Saat:</span>
          <span class="info-value" id="secilenHaftalikSaat">-</span>
        </div>

        <div class="ders-atama-container">
          <!-- Sol: Ders Listesi -->
          <div>
            <h4 style="font-size: 14px; font-weight: 800; color: #1a1a1a; margin-bottom: 12px;">
              Mevcut Dersler
            </h4>
            <div class="ders-listesi" id="dersListesi">
              <div class="empty-message">Dersler yÃ¼kleniyor...</div>
            </div>
          </div>

          <!-- SaÄŸ: Atanan Dersler -->
          <div class="atanan-dersler">
            <h4>
              Atanan Dersler 
              (<span id="atananToplamSaat">0</span>/<span id="hedefToplamSaat">0</span> saat)
            </h4>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="atanan-ders-list" id="atananDersList">
              <div class="empty-message">HenÃ¼z ders eklenmedi</div>
            </div>
          </div>
        </div>

        <div class="kisit-info" style="margin-top: 20px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="16" x2="12" y2="12"/>
            <line x1="12" y1="8" x2="12.01" y2="8"/>
          </svg>
          <span>
            Toplam ders saati hedef ile eÅŸleÅŸmelidir. Fazla veya eksik saat ile devam edemezsiniz.
          </span>
        </div>
      </div>

      <!-- ========================================== -->
      <!-- STEP 4: Ã–ÄRETMEN ATA -->
      <!-- ========================================== -->
      <div class="atama-content" data-step="4">
        <h3>ğŸ‘¨â€ğŸ« Derslere Ã–ÄŸretmen AtayÄ±nÄ±z</h3>
        
        <div class="kisit-info" style="margin-bottom: 20px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="16" x2="12" y2="12"/>
            <line x1="12" y1="8" x2="12.01" y2="8"/>
          </svg>
          <span>
            Her ders iÃ§in bir Ã¶ÄŸretmen seÃ§melisiniz. AynÄ± Ã¶ÄŸretmen birden fazla derse atanabilir.
          </span>
        </div>

        <div class="ogretmen-atama-list" id="ogretmenAtamaList">
          <div class="empty-message">Ã–ÄŸretmen atama listesi hazÄ±rlanÄ±yor...</div>
        </div>
      </div>

      <!-- ========================================== -->
      <!-- STEP 5: KONTROL VE ONAY -->
      <!-- ========================================== -->
      <div class="atama-content" data-step="5">
        <h3>âœ… Kontrol ve Onay</h3>
        
        <div class="atama-ozet" id="atamaOzet">
          <div class="ozet-onay">
            <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#4caf50" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            <h3>Ã–zet hazÄ±rlanÄ±yor...</h3>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button class="btn btn-ghost" id="btnAtamaGeri" onclick="atamaGeriGit()" style="display: none;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="19" y1="12" x2="5" y2="12"/>
          <polyline points="12 19 5 12 12 5"/>
        </svg>
        Geri
      </button>
      
      <button class="btn btn-ghost" onclick="closeAtamaModal()">
        Ä°ptal
      </button>
      
      <button class="btn btn-primary" id="btnAtamaIleri" onclick="atamaIleriGit()">
        Ä°leri
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="12" x2="19" y2="12"/>
          <polyline points="12 5 19 12 12 19"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<!-- ============================================ -->
<!-- PROGRAM GÃ–RÃœNÃœM MODAL -->
<!-- ============================================ -->
<div class="viewer-modal-overlay" id="viewerModalOverlay" style="display: none;">
  <div class="viewer-modal">
    <div class="viewer-modal-header">
      <h2 id="viewerModalTitle">Program SeÃ§in</h2>
      <button class="viewer-modal-close" onclick="closeViewerModal()">Ã—</button>
    </div>
    <div class="viewer-modal-body" id="viewerModalBody">
      <!-- SÄ±nÄ±flar veya Ã–ÄŸretmenler buraya yÃ¼klenecek -->
    </div>
  </div>
</div>

<!-- ==========================================
     ğŸ¤– OTOMATÄ°K DAÄITIM MODALI
     ========================================== -->
<div class="modal-overlay" id="modalOtomatikDagitim" style="display: none;">
  <div class="modal-container" style="max-width: 900px;">
    <!-- Header -->
    <div class="modal-header">
      <h2>
        <span style="font-size: 28px; margin-right: 8px;">ğŸ¤–</span>
        <span>Otomatik Ders DaÄŸÄ±tÄ±mÄ±</span>
      </h2>
      <button class="modal-close" id="btnDagitimKapat">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <!-- Algoritma SeÃ§imi -->
      <div style="margin-bottom: 24px;">
        <h3 style="color: #1a1a1a; margin: 0 0 16px 0; font-size: 16px;">
          ğŸ§¬ Algoritma SeÃ§imi
        </h3>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
          <label style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;">
            <input type="checkbox" id="chkGA" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600; font-size: 14px;">Genetik Algoritma</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;">
            <input type="checkbox" id="chkACO" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600; font-size: 14px;">KarÄ±nca Kolonisi</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;">
            <input type="checkbox" id="chkSA" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600; font-size: 14px;">Tavlama Benzetimi</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;">
            <input type="checkbox" id="chkTabu" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600; font-size: 14px;">Tabu Arama</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;">
            <input type="checkbox" id="chkRL" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600; font-size: 14px;">PekiÅŸtirmeli Ã–ÄŸr.</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;">
            <input type="checkbox" id="chkFuzzy" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600; font-size: 14px;">BulanÄ±k MantÄ±k</span>
          </label>
        </div>
      </div>

      <!-- SeÃ§enekler -->
      <div style="margin-bottom: 24px;">
        <h3 style="color: #1a1a1a; margin: 0 0 16px 0; font-size: 16px;">
          âš™ï¸ DaÄŸÄ±tÄ±m SeÃ§enekleri
        </h3>
        <div style="display: grid; gap: 12px;">
          <label style="display: flex; align-items: center; gap: 8px;">
            <input type="checkbox" id="chkOgretmenTercih" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600;">Ã–ÄŸretmen tercihlerini dikkate al</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px;">
            <input type="checkbox" id="chkBlokDers" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600;">Blok dersleri farklÄ± gÃ¼nlere yerleÅŸtir</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px;">
            <input type="checkbox" id="chkBosPencere" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600;">BoÅŸ pencereleri minimize et</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px;">
            <input type="checkbox" id="chkGunDengeleme" checked style="width: 18px; height: 18px;">
            <span style="color: #1a1a1a; font-weight: 600;">GÃ¼nlÃ¼k ders yÃ¼kÃ¼nÃ¼ dengele</span>
          </label>
        </div>
      </div>

      <!-- HÄ±z/Kalite Dengesi -->
      <div style="margin-bottom: 24px;">
        <h3 style="color: #1a1a1a; margin: 0 0 16px 0; font-size: 16px;">
          âš–ï¸ HÄ±z / Kalite Dengesi
        </h3>
        <div style="display: flex; gap: 12px; align-items: center;">
          <span style="color: #666; font-size: 13px;">HÄ±zlÄ±</span>
          <input type="range" id="rangeHizKalite" min="1" max="5" value="3" style="flex: 1;">
          <span style="color: #666; font-size: 13px;">Kaliteli</span>
        </div>
        <p style="margin: 8px 0 0 0; color: #666; font-size: 12px; text-align: center;" id="hizKaliteText">
          Dengeli mod (Ã–nerilen)
        </p>
      </div>

      <!-- Bilgi Kutusu -->
      <div style="background: #e3f2fd; padding: 16px; border-radius: 8px; display: flex; gap: 12px; align-items: flex-start;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#2196f3" stroke-width="2">
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="16" x2="12" y2="12" />
          <line x1="12" y1="8" x2="12.01" y2="8" />
        </svg>
        <div>
          <strong style="color: #1a1a1a;">Tahmini SÃ¼re:</strong>
          <span style="color: #666;" id="tahminiSure">2-5 dakika</span>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid #e0e0e0; display: flex; justify-content: flex-end; gap: 12px;">
      <button class="btn-secondary" id="btnDagitimIptal" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 8px; cursor: pointer;">
        Ä°ptal
      </button>
      <button class="btn-primary" id="btnDagitimBaslat" style="padding: 10px 20px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
        ğŸš€ DaÄŸÄ±tÄ±mÄ± BaÅŸlat
      </button>
    </div>
  </div>
</div>

<!-- Ä°lerleme Modal -->
<div class="modal-overlay" id="modalDagitimIlerleme" style="display: none;">
  <div class="modal-container" style="max-width: 600px;">
    <div class="modal-body" style="padding: 40px; text-align: center;">
      <div style="font-size: 64px; margin-bottom: 16px;">ğŸ¤–</div>
      <h3 style="color: #1a1a1a; margin: 0 0 8px 0;">DaÄŸÄ±tÄ±m YapÄ±lÄ±yor...</h3>
      <p style="color: #666; margin: 0 0 24px 0;" id="ilerlemeText">BaÅŸlatÄ±lÄ±yor...</p>
      
      <div style="width: 100%; background: #e0e0e0; border-radius: 12px; height: 24px; overflow: hidden; margin-bottom: 16px;">
        <div id="ilerlemeBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); transition: width 0.3s;"></div>
      </div>
      
      <div style="color: #666; font-size: 14px;">
        <span id="ilerlemeYuzde">0</span>% tamamlandÄ±
      </div>
    </div>
  </div>
</div>

<script>
// HÄ±z/Kalite slider gÃ¼ncelleme
document.getElementById('rangeHizKalite')?.addEventListener('input', function() {
  const value = parseInt(this.value);
  const text = document.getElementById('hizKaliteText');
  const tahmini = document.getElementById('tahminiSure');
  
  const modes = {
    1: { text: 'Ã‡ok HÄ±zlÄ± (DÃ¼ÅŸÃ¼k kalite)', sure: '30 saniye - 1 dakika' },
    2: { text: 'HÄ±zlÄ±', sure: '1-2 dakika' },
    3: { text: 'Dengeli mod (Ã–nerilen)', sure: '2-5 dakika' },
    4: { text: 'Kaliteli', sure: '5-10 dakika' },
    5: { text: 'Ã‡ok Kaliteli (YavaÅŸ)', sure: '10-20 dakika' }
  };
  
  if (text) text.textContent = modes[value].text;
  if (tahmini) tahmini.textContent = modes[value].sure;
});
</script>

<script>
// ============================================
// ğŸ’¾ VERÄ°TABANINA ATAMA KAYDET FONKSÄ°YONU
// ============================================

/**
 * STEP 5'te "Ä°leri" butonuna tÄ±klandÄ±ÄŸÄ±nda Ã§aÄŸrÄ±lÄ±r
 * TÃ¼m atamalarÄ± veritabanÄ±na kaydeder
 */
async function saverrToDatabase() {
  try {
    console.log("ğŸ’¾ ============================================");
    console.log("ğŸ’¾ ATAMALARI VERÄ°TABANINA KAYDETME BAÅLADI");
    console.log("ğŸ’¾ ============================================");

    // 1. Program ID'yi al
    const programId = parseInt(localStorage.getItem("currentProgramId"));

    if (!programId) {
      console.error("âŒ Program ID bulunamadÄ±!");
      if (typeof ModernBildirim !== 'undefined') {
        ModernBildirim.error("Hata", "Program ID bulunamadÄ±! LÃ¼tfen Ã¶nce program oluÅŸturun.");
      }
      return false;
    }

    console.log(`ğŸ“‹ Program ID: ${programId}`);

    // 2. SeÃ§ili sÄ±nÄ±f ID'sini al (global deÄŸiÅŸkenden)
    if (typeof window.atamaModalState === 'undefined' || !window.atamaModalState.selectedSinifId) {
      console.error("âŒ SeÃ§ili sÄ±nÄ±f bulunamadÄ±!");
      if (typeof ModernBildirim !== 'undefined') {
        ModernBildirim.error("Hata", "SeÃ§ili sÄ±nÄ±f bulunamadÄ±!");
      }
      return false;
    }

    const sinifId = window.atamaModalState.selectedSinifId;
    console.log(`ğŸ« SeÃ§ili SÄ±nÄ±f ID: ${sinifId}`);

    // 3. Atanan dersleri al (global state'den)
    if (!window.atamaModalState.atananDersler || window.atamaModalState.atananDersler.length === 0) {
      console.error("âŒ HiÃ§ ders atamasÄ± bulunamadÄ±!");
      if (typeof ModernBildirim !== 'undefined') {
        ModernBildirim.error("Hata", "HiÃ§ ders atamasÄ± bulunamadÄ±!");
      }
      return false;
    }

    const atananDersler = window.atamaModalState.atananDersler;
    console.log(`ğŸ“š Toplam ${atananDersler.length} ders atamasÄ± bulundu`);

    // 4. Her ders iÃ§in Ã¶ÄŸretmen atamasÄ± kontrolÃ¼
    const eksikOgretmenler = atananDersler.filter(ders => !ders.ogretmenId);
    if (eksikOgretmenler.length > 0) {
      console.error("âŒ BazÄ± derslere Ã¶ÄŸretmen atanmamÄ±ÅŸ!");
      if (typeof ModernBildirim !== 'undefined') {
        ModernBildirim.error("Hata", `${eksikOgretmenler.length} derse Ã¶ÄŸretmen atanmamÄ±ÅŸ!`);
      }
      return false;
    }

    // 5. Bildirim gÃ¶ster
    if (typeof ModernBildirim !== 'undefined') {
      ModernBildirim.info("Ä°ÅŸleniyor", "Atamalar veritabanÄ±na kaydediliyor...");
    }

    // 6. Ã–nce bu sÄ±nÄ±fÄ±n eski atamalarÄ±nÄ± sil
    console.log(`ğŸ—‘ï¸ ${sinifId} numaralÄ± sÄ±nÄ±fÄ±n eski atamalarÄ± siliniyor...`);
    
    try {
      await window.electronAPI.dbQuery(
        "DELETE FROM sinif_ders_ogretmen WHERE program_id = ? AND sinif_id = ?",
        [programId, sinifId]
      );
      console.log("âœ… Eski atamalar silindi");
    } catch (error) {
      console.warn("âš ï¸ Eski atama silme hatasÄ± (devam ediliyor):", error);
    }

    // 7. Yeni atamalarÄ± kaydet
    let savedCount = 0;
    let errorCount = 0;

    console.log("ğŸ“¤ Yeni atamalar kaydediliyor...");

    for (const ders of atananDersler) {
      try {
        const result = await window.electronAPI.dbQuery(
          `INSERT INTO sinif_ders_ogretmen 
           (program_id, sinif_id, ders_id, ogretmen_id, haftalik_ders_saati) 
           VALUES (?, ?, ?, ?, ?)`,
          [
            programId,
            sinifId,
            ders.dersId,
            ders.ogretmenId,
            ders.haftalikSaat
          ]
        );

        savedCount++;
        console.log(`  âœ… ${savedCount}. Atama kaydedildi:`, {
          ders: ders.dersAd,
          ogretmen: ders.ogretmenAd,
          saat: ders.haftalikSaat
        });

      } catch (error) {
        errorCount++;
        console.error(`  âŒ ${errorCount}. Atama kaydetme hatasÄ±:`, error, ders);
      }
    }

    // 8. SonuÃ§ bildirimi
    console.log("ğŸ’¾ ============================================");
    console.log(`âœ… KAYIT TAMAMLANDI: ${savedCount}/${atananDersler.length} atama kaydedildi`);
    if (errorCount > 0) {
      console.warn(`âš ï¸ ${errorCount} atama kaydedilemedi`);
    }
    console.log("ğŸ’¾ ============================================");

    if (typeof ModernBildirim !== 'undefined') {
      if (savedCount === atananDersler.length) {
        ModernBildirim.success(
          "BaÅŸarÄ±lÄ±!",
          `${savedCount} ders atamasÄ± veritabanÄ±na kaydedildi!`
        );
      } else {
        ModernBildirim.warning(
          "KÄ±smen BaÅŸarÄ±lÄ±",
          `${savedCount}/${atananDersler.length} atama kaydedildi. ${errorCount} hata oluÅŸtu.`
        );
      }
    }

    // 9. LocalStorage'a da kaydet (yedek)
    const localStorageKey = `sinifDersAtamalari_${programId}`;
    const mevcutAtamalar = JSON.parse(localStorage.getItem(localStorageKey) || "[]");
    
    // Bu sÄ±nÄ±fÄ±n eski atamalarÄ±nÄ± sil
    const filteredAtamalar = mevcutAtamalar.filter(a => a.sinif_id !== sinifId);
    
    // Yeni atamalarÄ± ekle
    atananDersler.forEach(ders => {
      filteredAtamalar.push({
        program_id: programId,
        sinif_id: sinifId,
        ders_id: ders.dersId,
        ders_adi: ders.dersAd,
        ogretmen_id: ders.ogretmenId,
        ogretmen_adi: ders.ogretmenAd,
        haftalik_ders_saati: ders.haftalikSaat
      });
    });
    
    localStorage.setItem(localStorageKey, JSON.stringify(filteredAtamalar));
    console.log("ğŸ’¾ LocalStorage'a da kaydedildi (yedek)");

    return true;

  } catch (error) {
    console.error("âŒ Kaydetme hatasÄ±:", error);
    if (typeof ModernBildirim !== 'undefined') {
      ModernBildirim.error("Hata", "Atamalar kaydedilemedi: " + error.message);
    }
    return false;
  }
}

// ============================================
// ğŸ”„ MEVCUT atamaIleriGit() FONKSÄ°YONUNA ENTEGRE ET
// ============================================

// Mevcut atamaIleriGit() fonksiyonunu bul ve STEP 5'te kaydetme ekle
(function() {
  // Sayfa yÃ¼klendiÄŸinde event listener ekle
  document.addEventListener('DOMContentLoaded', function() {
    console.log("ğŸ“‹ Atama modal kayÄ±t fonksiyonu hazÄ±r");
  });
})();
</script>

<!-- ============================================ -->
<!-- VERÄ° YÃ–NETÄ°M SÄ°STEMÄ° -->
<!-- ============================================ -->
<script src="schedule-data-manager.js"></script>
<script src="schedule-constraints.js"></script>
<script src="schedule-preferences.js"></script>
<script src="schedule-drag-drop.js"></script>

<!-- ============================================ -->
<!-- AÅAMA 1: TEMEL PERFORMANS MODÃœLLERÄ° -->
<!-- ============================================ -->
<script src="../js/modules/algorithms/schedule-scoring.js"></script>
<script src="../js/modules/algorithms/solver-pipeline.js"></script>
<script src="../js/modules/algorithms/incremental-conflict-cache.js"></script>
<script src="../js/modules/algorithms/constraint-preprocessor.js"></script>
<script src="../js/modules/algorithms/fairness-engine.js"></script>
<script src="../js/modules/algorithms/solution-stabilizer.js"></script>
<script src="../js/modules/algorithms/block-structure.js"></script>
<script src="../js/modules/algorithms/block-placement-controller.js"></script>

<!-- ============================================ -->
<!-- AÅAMA 2: OPTIMIZATION MODÃœLLERÄ° -->
<!-- ============================================ -->
<script src="../js/modules/algorithms/block-day-validator.js"></script>
<script src="../js/modules/algorithms/block-consecutive-check.js"></script>
<script src="../js/modules/algorithms/block-aware-swap.js"></script>
<script src="../js/modules/algorithms/parallel-solver.js"></script>
<script src="../js/modules/algorithms/save-manager.js"></script>
<script src="../js/modules/algorithms/etkilenen-ogretmen-finder.js"></script>

<!-- ============================================ -->
<!-- AÅAMA 3: UX VE GÃ–RSELLEÅTÄ°RME MODÃœLLERÄ° -->
<!-- ============================================ -->
<script src="../js/modules/algorithms/progress-tracker.js"></script>
<script src="../js/modules/algorithms/interactive-schedule-viewer.js"></script>
<script src="../js/modules/algorithms/schedule-comparison-tool.js"></script>
<script src="../js/modules/algorithms/algorithm-visualizer.js"></script>
<script src="../js/modules/algorithms/performance-monitor.js"></script>
<script src="../js/modules/algorithms/debug-logger.js"></script>

<!-- ============================================ -->
<!-- YAPABÄ°LÄ°RSEK: GELÄ°ÅMÄ°Å ALGORÄ°TMALAR -->
<!-- ============================================ -->
<script src="../js/modules/algorithms/weighted-constraint-system.js"></script>
<script src="../js/modules/algorithms/pattern-memory.js"></script>
<script src="../js/modules/algorithms/reinforcement-learning.js"></script>
<script src="../js/modules/algorithms/fuzzy-logic.js"></script>
<script src="../js/modules/algorithms/genetic-algorithm.js"></script>
<script src="../js/modules/algorithms/ant-colony-optimization.js"></script>
<script src="../js/modules/algorithms/simulated-annealing.js"></script>
<script src="../js/modules/algorithms/tabu-search.js"></script>
<script src="../js/modules/algorithms/meta-controller.js"></script>

<!-- ============================================ -->
<!-- ANA ALGORÄ°TMA (TÃ¼m modÃ¼llerden sonra!) -->
<!-- ============================================ -->
<script src="../js/modules/algorithms/schedule-algorithm-v2.js"></script>

<!-- ============================================ -->
<!-- YARDIMCI MODÃœLLER -->
<!-- ============================================ -->
<script src="../js/modules/helpers/distribution-analyzer.js"></script>
<script src="../js/modules/helpers/undo-redo-manager.js"></script>
<script src="../js/modules/helpers/lock-manager.js"></script>
<script src="../js/modules/helpers/export-import-manager.js"></script>
<script src="../js/modules/helpers/statistics-manager.js"></script>
<script src="../js/modules/helpers/conflict-detector.js"></script>

<!-- ============================================ -->
<!-- Ã–ZELLÄ°K MODÃœLLERÄ° -->
<!-- ============================================ -->
<script src="../js/modules/features/swap-engine.js"></script>
<script src="../js/modules/features/live-scheduler.js"></script>

<!-- ============================================ -->
<!-- ESKÄ° MODÃœLLER (Geriye DÃ¶nÃ¼k Uyumluluk) -->
<!-- ============================================ -->
<script src="schedule-viewer.js"></script>
<script src="../bilesenler/bildirim-sistemi.js"></script>

<!-- ============================================ -->
<!-- AKILLI ASÄ°STAN -->
<!-- ============================================ -->
<script src="akilli-asistan-kontrol.js"></script>

<!-- ============================================ -->
<!-- CANLI DAÄITIM MODÃœLLERÄ° -->
<!-- ============================================ -->
<script src="canli-dagitim-ui.js"></script>
<script src="canli-dagitim-blok-manager.js"></script>
<script src="canli-dagitim-grid.js"></script>
<script src="canli-dagitim-main.js"></script>

<!-- ============================================ -->
<!-- ANA PROGRAM (EN SON!) -->
<!-- ============================================ -->
<script src="program-olustur.js"></script>

</body>
</html>