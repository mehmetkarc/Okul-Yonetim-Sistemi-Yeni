<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <title>Ã–ÄŸrenci Listesi</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Times New Roman", serif;
        font-size: 11pt;
        line-height: 1.3;
        margin: 0;
        padding: 20mm;
        color: #000;
        background: white;
      }

      .header {
        text-align: center;
        margin-bottom: 20px;
      }

      .header h2 {
        margin: 10px 0;
        color: #000;
        font-size: 18pt;
        font-weight: bold;
      }

      /* Gezi Bilgileri Tablosu */
      .gezi-bilgi-tablo {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      .gezi-bilgi-tablo td {
        border: 1px solid #000;
        padding: 8px;
        color: #000;
        font-size: 11pt;
      }

      .gezi-bilgi-tablo .label {
        font-weight: bold;
        width: 200px;
        background: #b3d9ff; /* AÃ‡IK MAVÄ° */
      }

      /* Ã–ÄŸrenci Tablosu */
      table.ogrenci-tablo {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      .ogrenci-tablo th,
      .ogrenci-tablo td {
        border: 1px solid #000;
        padding: 6px;
        text-align: center;
        color: #000;
        font-size: 10pt;
        vertical-align: middle;
      }

      .ogrenci-tablo th {
        background: #d9d9d9; /* GRÄ° */
        font-weight: bold;
        text-align: center;
        color: #000;
      }

      .ogrenci-tablo td.ad-soyad {
        text-align: left;
        padding-left: 10px;
      }

      /* DÃ¼zenlenebilir hÃ¼creler */
      .editable {
        background: #ffffcc !important; /* AÃ‡IK SARI */
        cursor: text !important;
        min-height: 20px;
        position: relative;
      }

      .editable:hover {
        background: #ffff99 !important;
        outline: 2px solid #ffd700;
      }

      .editable:focus {
        background: #ffeb3b !important;
        outline: 2px solid #ff9800;
      }

      .editable:empty:before {
        content: "TÄ±klayÄ±n";
        color: #999;
        font-style: italic;
      }

      .footer-text {
        margin-top: 20px;
        font-size: 11pt;
        color: #000;
        line-height: 1.5;
        text-align: justify;
      }

      .tarih-sag {
        text-align: right;
        margin-top: 30px;
        font-size: 10pt;
        color: #000;
      }

      /* Print AyarlarÄ± - DÄ°KEY (Portrait) */
      @media print {
        @page {
          size: A4 portrait;
          margin: 15mm;
        }

        body {
          margin: 0;
          padding: 0;
        }

        /* Print'te dÃ¼zenlenebilir alanlar normal gÃ¶rÃ¼nsÃ¼n */
        .editable {
          background: white !important;
          outline: none !important;
          cursor: default !important;
        }

        .editable:empty:before {
          content: "";
        }

        .no-print {
          display: none !important;
        }

        /* Print'te gezi bilgileri tablosu */
        .gezi-bilgi-tablo .label {
          background: #e0e0e0 !important;
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }

        /* Print'te tablo baÅŸlÄ±klarÄ± */
        .ogrenci-tablo th {
          background: #e0e0e0 !important;
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }
      }

      /* Ãœst Butonlar */
      .top-buttons {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 15px;
        text-align: center;
        margin: -20mm -20mm 20px -20mm;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .top-buttons button {
        padding: 12px 24px;
        border: none;
        cursor: pointer;
        font-size: 15px;
        font-weight: 700;
        border-radius: 8px;
        margin: 0 8px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .btn-pdf {
        background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        color: white;
      }

      .btn-pdf:hover {
        background: linear-gradient(135deg, #229954 0%, #1e8449 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(39, 174, 96, 0.4);
      }

      .btn-close {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        color: white;
      }

      .btn-close:hover {
        background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(231, 76, 60, 0.4);
      }
    </style>
  </head>
  <body>
    <div class="top-buttons no-print">
      <button class="btn-pdf" onclick="window.print()">
        ðŸ“„ PDF Olarak Kaydet / YazdÄ±r
      </button>
      <button class="btn-close" onclick="window.close()">âœ– Kapat</button>
    </div>

    <div class="header">
      <h2>Ã–ÄžRENCÄ° LÄ°STESÄ°</h2>
    </div>

    <!-- Gezi Bilgileri Tablosu -->
    <table class="gezi-bilgi-tablo">
      <tr>
        <td class="label">Gezi Yeri</td>
        <td id="geziYeri">-</td>
      </tr>
      <tr>
        <td class="label">Gezi Tarihi ve Saati</td>
        <td id="gidisTarih">-</td>
      </tr>
      <tr>
        <td class="label">DÃ¶nÃ¼ÅŸ Tarihi ve Saati</td>
        <td id="donusTarih">-</td>
      </tr>
    </table>

    <!-- Ã–ÄŸrenci Tablosu -->
    <table class="ogrenci-tablo">
      <thead>
        <tr>
          <th style="width: 40px">S.No</th>
          <th style="width: 60px">SÄ±nÄ±fÄ±</th>
          <th style="width: 70px">Okul No</th>
          <th>AdÄ± SoyadÄ±</th>
          <th style="width: 70px">Cinsiyeti</th>
          <th style="width: 110px">Anne Tel No</th>
          <th style="width: 110px">Baba Tel No</th>
        </tr>
      </thead>
      <tbody id="ogrenciListesi">
        <!-- JavaScript ile doldurulacak -->
      </tbody>
    </table>

    <div class="footer-text">
      <p>
        <strong
          ><span id="baslangicTarih">-</span> -
          <span id="bitisTarih">-</span></strong
        >
        tarihleri arasÄ±nda <strong><span id="geziYeriAlt">-</span></strong> yere
        yapÄ±lacak geziye toplam
        <strong><span id="toplamOgrenci">0</span> Ã¶ÄŸrenci</strong> katÄ±lacaktÄ±r.
      </p>
    </div>

    <p class="tarih-sag">Tarih: <span id="bugunTarih">-</span></p>

    <script>
      // Telefon formatla (0 555 111 11 11)
      function formatTelefon(tel) {
        if (!tel) return "";
        tel = tel.replace(/\D/g, "");

        if (tel.length === 11 && tel.startsWith("0")) {
          return `${tel.substr(0, 1)} ${tel.substr(1, 3)} ${tel.substr(
            4,
            3
          )} ${tel.substr(7, 2)} ${tel.substr(9, 2)}`;
        } else if (tel.length === 10) {
          return `0 ${tel.substr(0, 3)} ${tel.substr(3, 3)} ${tel.substr(
            6,
            2
          )} ${tel.substr(8, 2)}`;
        }
        return tel;
      }

      // DÃ¼zenlenebilir hÃ¼cre yap
      function makeEditable(cell, defaultValue) {
        cell.contentEditable = true;
        cell.className = "editable";

        if (defaultValue && defaultValue.trim() !== "") {
          cell.textContent = formatTelefon(defaultValue);
        }

        // Enter tuÅŸu ile bir sonraki hÃ¼creye geÃ§
        cell.addEventListener("keydown", function (e) {
          if (e.key === "Enter") {
            e.preventDefault();
            this.blur();

            const editables = Array.from(
              document.querySelectorAll(".editable")
            );
            const currentIndex = editables.indexOf(this);
            if (currentIndex < editables.length - 1) {
              editables[currentIndex + 1].focus();
            }
          }
        });

        // Focus olduÄŸunda seÃ§
        cell.addEventListener("focus", function () {
          const range = document.createRange();
          range.selectNodeContents(this);
          const sel = window.getSelection();
          sel.removeAllRanges();
          sel.addRange(range);
        });

        // Blur olduÄŸunda formatla
        cell.addEventListener("blur", function () {
          const value = this.textContent.trim();
          if (value && value !== "TÄ±klayÄ±n") {
            this.textContent = formatTelefon(value);
          }
        });
      }

      console.log("âœ… Ã–ÄŸrenci Listesi Åžablonu YÃ¼klendi");
    </script>
  </body>
</html>
